<!DOCTYPE html>

<html>
    <head>
        <!-- AFrame -->
        <script src="//aframe.io/releases/0.8.2/aframe.min.js"></script>
        <!-- Extras : Movement Controls -->
        <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v5.0.0/dist/aframe-extras.min.js"></script>
        <!-- Physics -->
        <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.3.0/dist/aframe-physics-system.min.js"></script>
        <!-- Templates -->
        <script src="https://unpkg.com/aframe-template-component@3.x.x/dist/aframe-template-component.min.js"></script>
        <!-- Layouting -->
        <script src="https://unpkg.com/aframe-layout-component@4.x.x/dist/aframe-layout-component.min.js"></script>
        <!-- Environment -->
        <script src="https://rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>
        <!-- Event setters -->
        <script src="https://unpkg.com/aframe-event-set-component@5.x.x/dist/aframe-event-set-component.min.js"></script>
        <!-- Proxy Event -->
        <script src="https://unpkg.com/aframe-proxy-event-component/dist/aframe-proxy-event-component.min.js"></script>
        <!-- Font Geometry for 3D text -->
        <script src="https://unpkg.com/aframe-text-geometry-component@0.5.1/dist/aframe-text-geometry-component.min.js"></script>
        <!-- Custom -->
        <script src="components/logger.js"></script>
        <script src="components/maze.js"></script>
        <script src="components/clock.js"></script>
        <script src="components/jump.js"></script>
        <!-- Camera Object Collider -->
        <script src="components/kinema-body.js"></script>
    </head>

    <body>
        <a-scene
            shadow
            sound="src: url(./assets/background.wav); loop: true; autoplay: true; volume: 6"
        >
            <a-assets>
                <img id="grass" src="assets/dark-grass.jpg" />
                <img id="trees" src="assets/dark-trees.jpg" />
                <a-asset-item
                    id="wall"
                    src="models/wall/scene.gltf"
                ></a-asset-item>
                <a-mixin
                    id="wallVoxel"
                    class="wall"
                    static-body
                    shadow="cast: true;"
                    geometry="primitive: box; height: 3.95; width: 0.1; depth: 3.95;"
                    material="src: #trees; color: #933838;"
                    event-set__collide="material.color: red"
                >
                </a-mixin>
            </a-assets>

            <!-- gltf-model="#wall" -->
            <!-- Maze -->
            <!-- You can change the height and width here -->
            <!-- Increments of 4 -->
            <a-entity
                id="amaze"
                amaze="height: 60; width: 60"
                position="0 0 0"
            ></a-entity>

            <!-- Testing adding in a model for the walls -->
            <!-- <a-entity
                gltf-model="#wall"
                position="28 1 -5"
                scale="0.001 0.001 0.001"
                rotation="0 -90 0"
            ></a-entity> -->

            <!-- Center Positioned Clock -->
            <!-- Because of the arctan calc, it'll put the "back" of the clock to the use and flip it around past 90 degrees. So I just put two clocks back to back with a sheet separating them instead of trying to figure out the calculation for now.
            -->
            <a-entity
                clock
                id="clock-container"
                geometry="primitive: box; height: 4; width: 0.1; depth: 8;"
                position="28 18 -28"
                material="color: #191919"
                sound="src: url(./assets/gong1.wav); volume: 10;"
            >
                <a-entity
                    class="clock"
                    text-geometry="value: 0:00; size: 2.5; height: 0.1;"
                    position="0 -1 -3.25"
                    rotation="0 -90 0"
                    material="color: #933838;"
                >
                </a-entity>
                <a-entity
                    class="clock"
                    text-geometry="value: 0:00; size: 2.5; height: 0.1;"
                    position="0 -1 4"
                    rotation="0 90 0"
                    material="color: #933838;"
                >
                </a-entity>
            </a-entity>

            <!-- StartGame Plate -->
            <a-entity
                static-body
                id="startPlate"
                geometry="primitive: plane; height: 0.1; width: 4"
                material="opacity: 0"
                rotation="-90 0 0"
                position="28 0.01 0.05"
                event-set__collide="material.color: blue"
                proxy-event="event: collide; to: #amaze; as: startGame;"
            ></a-entity>

            <!-- Endgame plate -->
            <a-entity
                static-body
                id="endPlate"
                geometry="primitive: plane; height: 0.5; width: 4"
                material="color: red"
                rotation="-90 0 0"
                position="28 0.01 -60"
                event-set__collide="material.color: blue"
                proxy-event="event: collide; to: #amaze; as: gameOver;"
            ></a-entity>

            <!-- Starting Room -->
            <a-entity
                logger
                mixin="wallVoxel"
                position="30 2 2"
                rotation="0 0 0"
            ></a-entity>
            <a-entity
                mixin="wallVoxel"
                position="26 2 2"
                rotation="0 0 0"
            ></a-entity>
            <a-entity
                mixin="wallVoxel"
                position="28 2 4"
                rotation="0 90 0"
            ></a-entity>

            <!-- Wanted to test 2 different styles of fonts -->
            <!-- Candidly, Regular text is easier to deal with, but geometry text is easier to read -->
            <a-entity position="28 0 0">
                <a-entity
                    text-geometry="value: Welcome!; size: 0.5; height: 0.02;"
                    position="-1.5 4 0"
                    material="color: black;"
                ></a-entity>
                <a-entity
                    text-geometry="value: Are you ready to get lost?; size: 0.2; height: 0.02"
                    position="-1.5 3.5 0"
                    material="color: black"
                >
                </a-entity>
            </a-entity>
            <a-entity
                text="value: All you have to do is find the exit. \n Good Luck!; color: black; side: double; width: 4; align: center; baseline: center;"
                position="0 3 0"
                material="color: blue;"
            ></a-entity>

            <!-- Ground -->
            <a-plane
                static-body
                position="44 0 -46"
                rotation="-90 0 0"
                width="100"
                height="100"
                material="src: #grass; repeat: 10 10; color: #474747"
                shadow="receive: true; cast: true"
            ></a-plane>

            <!-- Sky -->
            <a-sky color="#191919"></a-sky>
            <a-entity
                light="type: ambient; color: #fff; intensity: 1"
            ></a-entity>

            <!-- Moon -->
            <a-entity
                geometry="primitive: sphere; radius: 3"
                position="-28 56 -56"
                material="color: #d1d1d1; emissive: #933838; emissiveIntensity: 0.3"
            >
                <a-entity
                    light="type: point; color: #FFF; intensity: 0.4; decay: 2; castShadow: true;"
                ></a-entity>
            </a-entity>

            <!-- Camera & User -->
            <a-entity
                id="player"
                kinema-body="radius: 0.2;"
                jump
                movement-controls="fly: false"
                position="28 1 3"
            >
                <!-- I basically set this to 10.6 to see everything and 1.6 to play the game -->
                <a-entity camera look-controls position="0 1.6 0"> </a-entity>
                <!-- Left Hand -->
                <!-- <a-entity id="rightHand" hand-controls="left"> -->
                <a-entity
                    vive-controls="hand: left; model:false"
                    oculus-touch-controls="hand: left; model:false"
                    haptics="dur: 40"
                >
                    <a-sphere
                        radius="0.04"
                        material="transparent: true; opacity: 0.3; color: #517ecb; emissive: #fff; emissiveIntensity: 0.4"
                        animation__emissive="property: material.emissiveIntensity; from: 1.0; to: 0.4; dur: 800; startEvents: hit"
                        animation__opacity="property: material.opacity; from: 1.0; to: 0.3; dur: 800; startEvents: hit"
                    ></a-sphere>
                </a-entity>
                <!-- </a-entity> -->
                <!-- Right Hand -->
                <a-entity id="rightHand" hand-controls="right">
                    <a-entity
                        vive-controls="hand: right; model:false"
                        oculus-touch-controls="hand: right; model:false"
                        haptics="dur: 40"
                    >
                        <a-cursor
                            raycaster="showLine: true"
                            rotation="0 20 0"
                        ></a-cursor>
                    </a-entity>
                </a-entity>
            </a-entity>
        </a-scene>
    </body>
</html>
